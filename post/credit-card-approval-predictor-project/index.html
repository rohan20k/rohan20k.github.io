<!DOCTYPE html>
<html lang="en" data-theme=""><head>
    <title> Rohan Khurana | Hello There üëã . It&#39;s Great to have you here, this is a detailed walktrhrough for my Credit Card Approval Predictor project </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.76.3" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description" content="Graduate Student ‚óè Data Science ‚óè Software Development">
    
    <link rel="stylesheet"
          href="https://rohan20k.github.io/css/style.min.2911bc404e247663364f082fdbb2c93cb55da039612db0d57edf20c141f3723c.css"
          integrity="sha256-KRG8QE4kdmM2Twgv27LJPLVdoDlhLbDVft8gwUHzcjw="
          crossorigin="anonymous"
          type="text/css"><link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
          integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    
    <link rel="shortcut icon" href="https://rohan20k.github.io/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="https://rohan20k.github.io/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://rohan20k.github.io/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://rohan20k.github.io/favicons/favicon-16x16.png">

    <link rel="canonical" href="https://rohan20k.github.io/post/credit-card-approval-predictor-project/">

    
    
    
    
    <script type="text/javascript"
            src="https://rohan20k.github.io/js/anatole-header.min.e782db136ec18d105a4552702eac49f4620d6867da3fbf808bd53e806c96be6e.js"
            integrity="sha256-54LbE27BjRBaRVJwLqxJ9GINaGfaP7&#43;Ai9U&#43;gGyWvm4="
            crossorigin="anonymous"></script>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hello There üëã . It&#39;s Great to have you here, this is a detailed walktrhrough for my Credit Card Approval Predictor project"/>
<meta name="twitter:description" content="An intresting attemp at using the power of machine learning to predict if a credit card application will get approval or not"/>

</head>
<body><div class="sidebar animated fadeInDown">
    <div class="logo-title">
        <div class="title">
            <img src="https://rohan20k.github.io/images/profile.png" alt="profile picture">
            <h3 title=""><a href="/">Hello I&#39;m Rohan Khurana</a></h3>
            <div class="description">
                <p>Graduate Student ‚óè Data Science ‚óè Software Development</p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="https://www.linkedin.com/in/rohankhurana" rel="me" aria-label="Linkedin">
                    <i class="fa fa-2x fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rohan20k" rel="me" aria-label="GitHub">
                    <i class="fa fa-2x fa-github" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="mailto:rohan20k@uw.edu" rel="me" aria-label="e-mail">
                    <i class="fa fa-2x fa-envelope" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://drive.google.com/file/d/1uLHfwY3fbOE_u1ubDvHwNTVZuC7utHWF/view?usp=sharing" rel="me" aria-label="resume">
                    <i class="fa fa-2x fa-download" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy; Rohan Khurana 2020 </div>
    </div>
</div>
<div class="main">
    <div class="page-top animated fadeInDown">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/about"
                        
                   title="">About</a></li>
        
            
            <li><a 
                   href="/project"
                        
                   title="">Projects</a></li>
        
            
            <li><a 
                   href="/experience"
                        
                   title="">Experience</a></li>
        
            
            <li><a 
                   href="/testimonial"
                        
                   title="">Testimonials</a></li>
        
            
            <li><a 
                   href="https://drive.google.com/file/d/1uLHfwY3fbOE_u1ubDvHwNTVZuC7utHWF/view?usp=sharing"
                        
                            target="_blank"
                            rel="noopener noreferrer"
                        
                   title="">Resume</a></li>
        
        
        <li class="theme-switch-item">
            <a class="theme-switch" title="Switch Theme">
                <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
    <div class="post animated fadeInDown">
        <div class="post-content">

            <div class="post-title">
                <h3>Hello There üëã . It&#39;s Great to have you here, this is a detailed walktrhrough for my Credit Card Approval Predictor project</h3>
                
                    <div class="info">
                        <em class="fa fa-sun-o"></em>
                        <span class="date">Mon, Nov 2, 2020</span>
                        <em class="fa fa-clock-o"></em>
                        <span class="reading-time">13-minute read</span>
                    </div>
                
            </div>

            <h1 id="predicting-credit-card-request-approval">Predicting Credit Card Request Approval</h1>
<h1 id="introduction">Introduction</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;final_notebook&#39;</span>
PROJECT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;predicting_credit_card_approvals&#39;</span>
PYTHON_VERSION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;3.8.3&#39;</span>
AUTHOR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Rohan Khurana&#39;</span>
</code></pre></div><p>To check the exact python version installed in your system at the time of running this notebook, please run the following code -</p>
<pre><code class="language-from" data-lang="from">    print(python_version())
</code></pre><p>Also, in order to get the current version of all the packages that are installed in your system in a nice tabular format, you can use the following command -</p>
<pre><code class="language-pip" data-lang="pip"></code></pre><h2 id="project-begins-">Project Begins üöÄ</h2>
<p>Through this notebook I have tried to use the power of machine learning to build an automatic credit card approval using machine learning techniques.</p>
<p>The dataset we are using for this project is from the UCI Machine Learning Repository and can be downloaded found here - <a href="http://archive.ics.uci.edu/ml/datasets/credit+approval">http://archive.ics.uci.edu/ml/datasets/credit+approval</a></p>
<p>The dataset can also be found in the project repository <!-- raw HTML omitted -->predicting_credit_card_approvals/data/cc_approvals.data<!-- raw HTML omitted --></p>
<p>The structure of the notebook is as follows -</p>
<ul>
<li>Load and inspect the dataset</li>
<li>Explore the numerical and non-numerical features that the notebook has. In addition, as mentioned in the dataset description we have to deal with values having different ranges and the missing values.</li>
<li>Preprocess the model to ensure the machine learning model we choose can make good predictions.</li>
<li>After preprocessing is complete, we need to do some EDA or Exploratory Data Analysis to build our intuition.</li>
<li>Finally we try to build a machine learning model that can predict if an indivisual&rsquo;s application for a credit card will be accepted or not ?</li>
</ul>
<h2 id="about-the-dataset-">About the Dataset üìä</h2>
<p>Data Set Description as Available on <a href="http://archive.ics.uci.edu/ml/datasets/credit+approval">http://archive.ics.uci.edu/ml/datasets/credit+approval</a></p>
<ol>
<li>
<p>Title: Credit Approval</p>
</li>
<li>
<p>Sources:
(confidential)
Submitted by <a href="mailto:quinlan@cs.su.oz.au">quinlan@cs.su.oz.au</a></p>
</li>
<li>
<p>Past Usage:</p>
<p>See Quinlan,</p>
<ul>
<li>&ldquo;Simplifying decision trees&rdquo;, Int J Man-Machine Studies 27,
Dec 1987, pp. 221-234.</li>
<li>&ldquo;C4.5: Programs for Machine Learning&rdquo;, Morgan Kaufmann, Oct 1992</li>
</ul>
</li>
<li>
<p>Relevant Information:</p>
<p>This file concerns credit card applications.  All attribute names
and values have been changed to meaningless symbols to protect
confidentiality of the data.</p>
<p>This dataset is interesting because there is a good mix of
attributes &ndash; continuous, nominal with small numbers of
values, and nominal with larger numbers of values.  There
are also a few missing values.</p>
</li>
<li>
<p>Number of Instances: 690</p>
</li>
<li>
<p>Number of Attributes: 15 + class attribute</p>
</li>
<li>
<p>Attribute Information:</p>
<p>A1:	b, a.    <br>
A2:	continuous.    <br>
A3:	continuous.     <br>
A4:	u, y, l, t.     <br>
A5:	g, p, gg.     <br>
A6:	c, d, cc, i, j, k, m, r, q, w, x, e, aa, ff.    <br>
A7:	v, h, bb, j, n, z, dd, ff, o.     <br>
A8:	continuous.      <br>
A9:	t, f.      <br>
A10: t, f.     <br>
A11: continuous.     <br>
A12: t, f.      <br>
A13: g, p, s.     <br>
A14: continuous.    <br>
A15: continuous.       <br>
A16: +,- (class attribute)</p>
</li>
<li>
<p>Missing Attribute Values:
37 cases (5%) have one or more missing values.  The missing
values from particular attributes are:</p>
<p>A1:  12  <br>
A2:  12  <br>
A4:   6    <br>
A5:   6   <br>
A6:   9   <br>
A7:   9     <br>
A14: 13</p>
</li>
<li>
<p>Class Distribution</p>
<p>+: 307 (44.5%)    <br>
-: 383 (55.5%)</p>
</li>
</ol>
<h2 id="required-imports">Required Imports</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd 
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
<span style="color:#75715e"># Import LabelEncoder</span>
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
<span style="color:#75715e"># Import train_test_split</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#75715e"># Import MinMaxScaler</span>
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
<span style="color:#75715e"># Import LogisticRegression</span>
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression 
<span style="color:#75715e"># Import confusion_matrix</span>
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix
<span style="color:#75715e"># Import GridSearchCV</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
</code></pre></div><h2 id="loading-the-dataset">Loading the Dataset</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#  We observe that the data doesn&#39;t have header, hence we pass header = None here. </span>
cc_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#34;data/cc_approvals.data&#34;</span>, header <span style="color:#f92672">=</span> None)  
</code></pre></div><p>Observing the first five rows of the dataframe -</p>
<ul>
<li>First observation, the dataset has feature names (or column headers) missing. These are most likely anonymized as we are dealing with sensitive financial information.</li>
<li>The data contains a mixture of numerical and non-numerical values.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cc_df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>We can observe that the output is a bit incomplete and difficult to comprehend hence I have used <!-- raw HTML omitted -->this blog<!-- raw HTML omitted --> to give a pretty good overview of the probable features.</p>
<p>For ease of analysis, I have assumed the column headers as mentioned in the in the blog.</p>
<p>From the blog, it can be stated that the probable features in a typical credit card application are as follows -</p>
<p><!-- raw HTML omitted -->Gender<!-- raw HTML omitted --><br>
<!-- raw HTML omitted -->Age<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->Debt<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->Married<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->BankCustomer<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->EducationLevel<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->Ethnicity<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->YearsEmployed<!-- raw HTML omitted --><br>
<!-- raw HTML omitted -->PriorDefault<!-- raw HTML omitted --><br>
<!-- raw HTML omitted -->Employed<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->CreditScore<!-- raw HTML omitted -->  <br>
<!-- raw HTML omitted -->DriversLicense<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->Citizen<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->ZipCode<!-- raw HTML omitted --> <br>
<!-- raw HTML omitted -->Income<!-- raw HTML omitted -->  <br>
<!-- raw HTML omitted -->ApprovalStatus<!-- raw HTML omitted --></p>
<h2 id="some-summary-statistics">Some Summary Statistics</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Print summary statistics</span>
<span style="color:#66d9ef">print</span>(cc_df<span style="color:#f92672">.</span>describe(include<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;all&#39;</span>))

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)

<span style="color:#75715e"># Print DataFrame information </span>
<span style="color:#66d9ef">print</span>(cc_df<span style="color:#f92672">.</span>info())

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)

<span style="color:#75715e"># Print missing values in the dataset</span>
cc_df<span style="color:#f92672">.</span>tail(<span style="color:#ae81ff">20</span>)
</code></pre></div><pre><code>         0    1           2    3    4    5    6           7    8    9   \
count   690  690  690.000000  690  690  690  690  690.000000  690  690   
unique    3  350         NaN    4    4   15   10         NaN    2    2   
top       b    ?         NaN    u    g    c    v         NaN    t    f   
freq    468   12         NaN  519  519  137  399         NaN  361  395   
mean    NaN  NaN    4.758725  NaN  NaN  NaN  NaN    2.223406  NaN  NaN   
std     NaN  NaN    4.978163  NaN  NaN  NaN  NaN    3.346513  NaN  NaN   
min     NaN  NaN    0.000000  NaN  NaN  NaN  NaN    0.000000  NaN  NaN   
25%     NaN  NaN    1.000000  NaN  NaN  NaN  NaN    0.165000  NaN  NaN   
50%     NaN  NaN    2.750000  NaN  NaN  NaN  NaN    1.000000  NaN  NaN   
75%     NaN  NaN    7.207500  NaN  NaN  NaN  NaN    2.625000  NaN  NaN   
max     NaN  NaN   28.000000  NaN  NaN  NaN  NaN   28.500000  NaN  NaN   

               10   11   12     13             14   15  
count   690.00000  690  690    690     690.000000  690  
unique        NaN    2    3    171            NaN    2  
top           NaN    f    g  00000            NaN    -  
freq          NaN  374  625    132            NaN  383  
mean      2.40000  NaN  NaN    NaN    1017.385507  NaN  
std       4.86294  NaN  NaN    NaN    5210.102598  NaN  
min       0.00000  NaN  NaN    NaN       0.000000  NaN  
25%       0.00000  NaN  NaN    NaN       0.000000  NaN  
50%       0.00000  NaN  NaN    NaN       5.000000  NaN  
75%       3.00000  NaN  NaN    NaN     395.500000  NaN  
max      67.00000  NaN  NaN    NaN  100000.000000  NaN  


&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 690 entries, 0 to 689
Data columns (total 16 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   0       690 non-null    object 
 1   1       690 non-null    object 
 2   2       690 non-null    float64
 3   3       690 non-null    object 
 4   4       690 non-null    object 
 5   5       690 non-null    object 
 6   6       690 non-null    object 
 7   7       690 non-null    float64
 8   8       690 non-null    object 
 9   9       690 non-null    object 
 10  10      690 non-null    int64  
 11  11      690 non-null    object 
 12  12      690 non-null    object 
 13  13      690 non-null    object 
 14  14      690 non-null    int64  
 15  15      690 non-null    object 
dtypes: float64(2), int64(2), object(12)
memory usage: 86.4+ KB
None
</code></pre>
<!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>We can observe, we have some &lsquo;?&rsquo; as our values. &lsquo;?&rsquo;, initially we can deal with the question marks by replacing them with NaNs.</p>
<p>The dataset contains numeric and non-numeric values that are of float64, int64 and object types. Specifically, the features 2, 7, 10 and 14 contain numeric values (of types float64, float64, int64 and int64 respectively) and all the other features contain non-numeric values.</p>
<p>The dataset also contains values from several ranges. Some features range from 0-28, 0-67 and even 0 - 100000.</p>
<h2 id="handling-the-missing-values">Handling the Missing Values</h2>
<h4 id="dealing-with-numerical-data">Dealing with Numerical Data</h4>
<p>I am trying to replace the missing values and not completely remove them as it could seriously affect the model performance or we could miss out on some important insights.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Checking if we have any missing values in the dataframe. </span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;The number of missing values in the dataframe is :&#34;</span>,cc_df<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>sum())
</code></pre></div><pre><code>The number of missing values in the dataframe is : 0
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Replacing &#34;?&#34; with NaN</span>
cc_df <span style="color:#f92672">=</span> cc_df<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;?&#39;</span>,np<span style="color:#f92672">.</span>nan)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Inspecting again if &#34;?&#34; is replaced by NaN or not as we had ? in the last few rows</span>
cc_df<span style="color:#f92672">.</span>tail(<span style="color:#ae81ff">20</span>)
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Now since we have replaced all the &lsquo;?&rsquo; values with NaNs we would now need to replace all the newly missing values created with something and we are using the respective column mean values here. The method is called as the <!-- raw HTML omitted -->mean imputation<!-- raw HTML omitted --> method.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Count the number of NaNs in the dataset to verify </span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;The number of missing values in the dataframe is :&#34;</span>,cc_df<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>sum())
</code></pre></div><pre><code>The number of missing values in the dataframe is : 67
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Impute the missing values with mean imputation</span>
cc_df<span style="color:#f92672">.</span>fillna(cc_df<span style="color:#f92672">.</span>mean(), inplace<span style="color:#f92672">=</span>True)
</code></pre></div><p>Till this point, the mean impuitation strategy is implied for all the numerical data that is present in the dataframe but it won&rsquo;t work in the treatment of missing values present in the columns containing non-numerical values. These columns are 0, 1, 3, 4, 5, 6 and 13. The columns with non-numerical values have the &ldquo;object&rdquo; datatype.</p>
<h4 id="dealing-with-non-numerical-data">Dealing with Non-Numerical Data</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(cc_df<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum(), cc_df<span style="color:#f92672">.</span>info())
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 690 entries, 0 to 689
Data columns (total 16 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   0       678 non-null    object 
 1   1       678 non-null    object 
 2   2       690 non-null    float64
 3   3       684 non-null    object 
 4   4       684 non-null    object 
 5   5       681 non-null    object 
 6   6       681 non-null    object 
 7   7       690 non-null    float64
 8   8       690 non-null    object 
 9   9       690 non-null    object 
 10  10      690 non-null    int64  
 11  11      690 non-null    object 
 12  12      690 non-null    object 
 13  13      677 non-null    object 
 14  14      690 non-null    int64  
 15  15      690 non-null    object 
dtypes: float64(2), int64(2), object(12)
memory usage: 86.4+ KB
0     12
1     12
2      0
3      6
4      6
5      9
6      9
7      0
8      0
9      0
10     0
11     0
12     0
13    13
14     0
15     0
dtype: int64 None
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">d_1 <span style="color:#f92672">=</span> {}
<span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> cc_df<span style="color:#f92672">.</span>columns:
    d_1[col] <span style="color:#f92672">=</span> [cc_df[col]<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum(),cc_df[col]<span style="color:#f92672">.</span>dtypes]
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dict_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(d_1<span style="color:#f92672">.</span>items(), columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;column_header&#39;</span>,<span style="color:#e6db74">&#39;number_of_missing_values and column data type&#39;</span>])
dict_df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> dict_df<span style="color:#f92672">.</span>index <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dict_df
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>We can observe in the above cell that missing values are only present in the columns with data type of &lsquo;object&rsquo; i.e. the non-numerical valued columns.</p>
<p>So we are going to iterate over all the columns of the dataframe and we are going to replace the missing value with most common non-numerical value in that particular column.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Iterate over each column of cc_apps</span>
<span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> cc_df<span style="color:#f92672">.</span>columns:
    <span style="color:#75715e"># Check if the column is of object type</span>
    <span style="color:#66d9ef">if</span> cc_df[col]<span style="color:#f92672">.</span>dtypes <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;object&#39;</span>:
        cc_df <span style="color:#f92672">=</span> cc_df<span style="color:#f92672">.</span>fillna(cc_df[col]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>index[<span style="color:#ae81ff">0</span>])

<span style="color:#75715e"># Count the number of NaNs in the dataset and print the counts to verify</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;The number of missing values in the dataframe is :&#34;</span>,cc_df<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>sum())
</code></pre></div><pre><code>The number of missing values in the dataframe is : 0
</code></pre>
<p>With the above steps, all the missing values are successfully and logically handled.</p>
<h2 id="additional-preprocessing-steps">Additional Preprocessing Steps</h2>
<p>The remaining preprocessing steps, before modelling can be applied as follows -</p>
<ol>
<li>Convert the non-numeric data into numeric format, this can be done by a technique called label encoding.</li>
<li>splitting the data into training and testing sets.</li>
<li>Scaling the feature values to a uniform range.</li>
</ol>
<h3 id="step-1---convert-the-non-numeric-data-into-numeric-format">Step 1 - Convert the non-numeric data into numeric format</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiating the above imported LabelEncoder</span>
le <span style="color:#f92672">=</span> LabelEncoder()

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)

<span style="color:#75715e"># Printing the datatypes of all the columns before label encoding</span>

<span style="color:#66d9ef">print</span>(cc_df<span style="color:#f92672">.</span>info())

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)

<span style="color:#75715e"># Applying label encoding to non-numerical columns </span>

<span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span> cc_df<span style="color:#f92672">.</span>columns:
    <span style="color:#75715e"># Compare if the dtype is object</span>
    <span style="color:#66d9ef">if</span> cc_df[col]<span style="color:#f92672">.</span>dtypes<span style="color:#f92672">==</span><span style="color:#e6db74">&#39;object&#39;</span>:
        <span style="color:#75715e"># Using the label encoder to do numeric transformation</span>
        
            cc_df[col] <span style="color:#f92672">=</span> le<span style="color:#f92672">.</span>fit_transform(cc_df[col])

<span style="color:#75715e"># Printing the datatypes of all the columns after label encoding</span>

<span style="color:#66d9ef">print</span>(cc_df<span style="color:#f92672">.</span>info())
</code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 690 entries, 0 to 689
Data columns (total 16 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   0       690 non-null    object 
 1   1       690 non-null    object 
 2   2       690 non-null    float64
 3   3       690 non-null    object 
 4   4       690 non-null    object 
 5   5       690 non-null    object 
 6   6       690 non-null    object 
 7   7       690 non-null    float64
 8   8       690 non-null    object 
 9   9       690 non-null    object 
 10  10      690 non-null    int64  
 11  11      690 non-null    object 
 12  12      690 non-null    object 
 13  13      690 non-null    object 
 14  14      690 non-null    int64  
 15  15      690 non-null    object 
dtypes: float64(2), int64(2), object(12)
memory usage: 86.4+ KB
None


&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 690 entries, 0 to 689
Data columns (total 16 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   0       690 non-null    int64  
 1   1       690 non-null    int64  
 2   2       690 non-null    float64
 3   3       690 non-null    int64  
 4   4       690 non-null    int64  
 5   5       690 non-null    int64  
 6   6       690 non-null    int64  
 7   7       690 non-null    float64
 8   8       690 non-null    int64  
 9   9       690 non-null    int64  
 10  10      690 non-null    int64  
 11  11      690 non-null    int64  
 12  12      690 non-null    int64  
 13  13      690 non-null    int64  
 14  14      690 non-null    int64  
 15  15      690 non-null    int64  
dtypes: float64(2), int64(14)
memory usage: 86.4 KB
None
</code></pre>
<p>We can observe the datatypes of all the previously object datatype columns has been changed.</p>
<h3 id="step-2---splitting-the-dataset-into-train-and-test-dataset">Step 2 - Splitting the dataset into train and test dataset</h3>
<p>Feature Selection -</p>
<p>Features like DriversLicense and ZipCode are not as important as the other features in the dataset for predicting
credit card approvals.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Drop the features 11 and 13 and convert the DataFrame to a NumPy array</span>
cc_df <span style="color:#f92672">=</span> cc_df<span style="color:#f92672">.</span>drop([cc_df<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">11</span>], cc_df<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">13</span>]], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Converting the dataframe values into a numpy array for ease in splitting the data</span>
cc_df_array <span style="color:#f92672">=</span> cc_df<span style="color:#f92672">.</span>to_numpy()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Segregate features and labels into separate variables</span>
X,y <span style="color:#f92672">=</span> cc_df_array[:,<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">13</span>] , cc_df_array[:,<span style="color:#ae81ff">13</span>]
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Split into train and test sets</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X,
                                                    y,
                                                    test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.33</span>,
                                                    random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
</code></pre></div><h3 id="rescaling-all-the-values-to-be-present-between-0-and-1">Rescaling all the values to be present between 0 and 1</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiate MinMaxScaler and use it to rescale X_train and X_test</span>
scaler <span style="color:#f92672">=</span> MinMaxScaler(feature_range<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>))
rescaledX_train <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(X_train)
rescaledX_test <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(X_test)
</code></pre></div><h2 id="model-selection-using-pearson-correlation-to-check-correlation-among-parameters">Model Selection, Using Pearson Correlation to check correlation among parameters</h2>
<p>Detecting whether an application is approved or not is a classification task and <!-- raw HTML omitted -->According to UCI<!-- raw HTML omitted -->, the dataset contains more instances that correspond to &lsquo;Denied&rsquo;status than instances corresponding to &ldquo;Approved&rdquo; status. Specifically, out of 690 instances, there are 383 (55.5%) applications that got denied and 307 (44.5%) applications that got approved.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Using Pearson Correlation</span>
plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">10</span>))
cor <span style="color:#f92672">=</span> cc_df<span style="color:#f92672">.</span>corr()
sns<span style="color:#f92672">.</span>heatmap(cor, annot<span style="color:#f92672">=</span>True, cmap<span style="color:#f92672">=</span>plt<span style="color:#f92672">.</span>cm<span style="color:#f92672">.</span>Reds)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_50_0.png" alt="png"></p>
<p>Observing the correlation plot we can say that the features are correlated to each other and since this is classification we can say generalized linear models perform well in these cases and hence we choose a Logistic Regression Model.</p>
<h3 id="making-predictions-and-evaluating-performance">Making Predictions and Evaluating Performance</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiate a LogisticRegression classifier with default parameter values</span>
logreg <span style="color:#f92672">=</span> LogisticRegression()

<span style="color:#75715e"># Fit logreg to the train set</span>
logreg<span style="color:#f92672">.</span>fit(rescaledX_train, y_train)
</code></pre></div><pre><code>LogisticRegression()
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Use logreg to predict instances from the test set and store it</span>
y_pred <span style="color:#f92672">=</span> logreg<span style="color:#f92672">.</span>predict(rescaledX_test)

<span style="color:#75715e"># Get the accuracy score of logreg model and print it</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Accuracy of logistic regression classifier: &#34;</span>, logreg<span style="color:#f92672">.</span>score(rescaledX_test,y_test))

<span style="color:#75715e"># Print the confusion matrix of the logreg model</span>
confusion_matrix(y_pred,y_test)

</code></pre></div><pre><code>Accuracy of logistic regression classifier:  0.8377192982456141





array([[92, 26],
       [11, 99]])
</code></pre>
<h3 id="attempting-to-improve-the-model-performance-using-grid-search-cv">Attempting to improve the model performance using Grid Search CV</h3>
<p>The above model performed very well with a model accuracy of about 87%.</p>
<p>Since there is always room for improvement, now we can try to improve upon the model performance by using grid search on the tol and max_iter hyperparameters of the logistic regression model</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Define the grid of values for tol and max_iter</span>
tol <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.01</span>, <span style="color:#ae81ff">0.001</span>, <span style="color:#ae81ff">0.0001</span>]
max_iter <span style="color:#f92672">=</span> [<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">200</span>]

<span style="color:#75715e"># Create a dictionary where tol and max_iter are keys and the lists of their values are corresponding values</span>
param_grid <span style="color:#f92672">=</span> dict(tol<span style="color:#f92672">=</span>tol, max_iter<span style="color:#f92672">=</span>max_iter)
<span style="color:#66d9ef">print</span>(param_grid)
</code></pre></div><pre><code>{'tol': [0.01, 0.001, 0.0001], 'max_iter': [50, 100, 150, 200]}
</code></pre>
<h3 id="instantiating-gridsearchcv-with-our-earlier-codelogregcode-model">Instantiating GridSearchCV with our earlier <!-- raw HTML omitted -->logreg<!-- raw HTML omitted --> model</h3>
<p>I have used GridSearchCV method because it is a popular method because it is simple to understand and because it generally results in a less biased or less optimistic estimate of the model skill than other methods, such as a simple train/test split.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Instantiate GridSearchCV with the required parameters</span>
grid_model <span style="color:#f92672">=</span> GridSearchCV(estimator <span style="color:#f92672">=</span> logreg, param_grid<span style="color:#f92672">=</span> param_grid, cv <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>)

<span style="color:#75715e"># Use scaler to rescale X and assign it to rescaledX</span>
rescaledX <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(X)

<span style="color:#75715e"># Fit data to grid_model</span>
grid_model_result <span style="color:#f92672">=</span> grid_model<span style="color:#f92672">.</span>fit(rescaledX, y)

<span style="color:#75715e"># Summarize results</span>
best_score, best_params <span style="color:#f92672">=</span> grid_model_result<span style="color:#f92672">.</span>best_score_, grid_model_result<span style="color:#f92672">.</span>best_params_
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Best: </span><span style="color:#e6db74">%f</span><span style="color:#e6db74"> using </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (best_score, best_params))
</code></pre></div><pre><code>Best: 0.850725 using {'max_iter': 50, 'tol': 0.01}
</code></pre>
<p>We can observe that our model accuracy is improved to about 85% with the best performing parameter values as max_iter = 50 and tol parameter value as 0.01</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div>
        </div>
        <div class="post-footer">
            <div class="info">
                
                
            </div>
        </div>

        
            
        
    </div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="https://rohan20k.github.io/js/jquery.min.86b1e8f819ee2d9099a783e50b49dff24282545fc40773861f9126b921532e4c.js"
        integrity="sha256-hrHo&#43;BnuLZCZp4PlC0nf8kKCVF/EB3OGH5EmuSFTLkw="
        crossorigin="anonymous"></script>




<script type="text/javascript"
        src="https://rohan20k.github.io/js/bundle.min.0f9c74cb78f13d1f15f33daff4037c70354f98acfbb97a6f61708966675c3cae.js"
        integrity="sha256-D5x0y3jxPR8V8z2v9AN8cDVPmKz7uXpvYXCJZmdcPK4="
        crossorigin="anonymous"></script>

<script type="text/javascript"
        src="https://rohan20k.github.io/js/medium-zoom.min.92f21c856129f84aeb719459b3e6ac621a3032fd7b180a18c04e1d12083f8aba.js"
        integrity="sha256-kvIchWEp&#43;ErrcZRZs&#43;asYhowMv17GAoYwE4dEgg/iro="
        crossorigin="anonymous"></script>
</body>

</html>
